# Google Cloud Platform (GCP) 設定ガイド

このアプリケーションでGmail連携機能を使用するために必要な、Google Cloud Platform側での設定手順を詳細に解説します。
APIの有効化からOAuth認証情報の作成まで、順を追って設定してください。

## 1. プロジェクトの作成

1.  [Google Cloud Console](https://console.cloud.google.com/) にアクセスします。
2.  画面左上のロゴの横にあるプロジェクト選択プルダウン（「プロジェクトの選択」または既存のプロジェクト名）をクリックします。
3.  「**新しいプロジェクト**」をクリックします。
4.  **プロジェクト名**: 任意の名前を入力します（例: `Career Manager App`）。
5.  「**作成**」をクリックします。
6.  通知エリア（ベルのアイコン）から、作成したプロジェクトを選択して切り替えます。

## 2. Gmail API の有効化

1.  左側のメニューから「**API とサービス**」>「**ライブラリ**」を選択します。
2.  検索バーに「**Gmail API**」と入力して検索します。
3.  検索結果から「**Gmail API**」をクリックします。
4.  「**有効にする**」ボタンをクリックします。

## 3. OAuth 同意画面の設定

APIを有効化した後、OAuth同意画面（ユーザーに許可を求める画面）を設定する必要があります。

1.  左側のメニューから「**API とサービス**」>「**OAuth 同意画面**」を選択します。
2.  **User Type**:
    *   **外部 (External)** を選択します（個人のGoogleアカウントでテストする場合）。
    *   「**作成**」をクリックします。
3.  **アプリ情報**:
    *   **アプリ名**: 任意の名前（例: `Career Manager`）。
    *   **ユーザーサポートメール**: あなたのメールアドレスを選択。
    *   **デベロッパーの連絡先情報**: あなたのメールアドレスを入力。
    *   「**保存して次へ**」をクリックします。
4.  **スコープ** (Scopes):
    *   「**スコープを追加または削除**」をクリックします。
    *   フィルタに `gmail.readonly` と入力するなどして、以下のスコープを探してチェックを入れます：
        *   `https://www.googleapis.com/auth/gmail.readonly` (メールの閲覧)
        *   ※ 必要に応じて `https://www.googleapis.com/auth/gmail.labels` なども追加できますが、基本は `readonly` で十分です。
    *   「**更新**」をクリックし、リストに追加されたことを確認して「**保存して次へ**」をクリックします。
5.  **テストユーザー** (Test Users):
    *   **重要**: アプリが「テスト中」ステータスの間は、ここで登録したユーザーしか認証できません。
    *   「**ADD USERS**」をクリックします。
    *   **あなた自身のGmailアドレス**（アプリで使用したいアドレス）を入力して追加します。
    *   「**保存して次へ**」をクリックします。
6.  概要を確認して「**ダッシュボードに戻る**」をクリックします。

## 4. 認証情報（OAuth クライアント ID）の作成

1.  左側のメニューから「**API とサービス**」>「**認証情報**」を選択します。
2.  画面上部の「**+ 認証情報を作成**」をクリックし、「**OAuth クライアント ID**」を選択します。
3.  **アプリケーションの種類**:
    *   「**デスクトップ アプリ**」または「**ウェブ アプリケーション**」を選択します。
    *   **推奨**: 今回のアプリはElectron製デスクトップアプリですが、リダイレクトフローの都合上、「**ウェブ アプリケーション**」として作成することをお勧めします（リダイレクトURIの検証が厳格なため）。
    *   名前: 任意の名前（例: `Career Manager Client`）。
4.  **承認済みのリダイレクト URI** (Authorized redirect URIs):
    *   「**ウェブ アプリケーション**」を選択した場合に表示されます。
    *   「**URI を追加**」をクリックします。
    *   以下のURLを正確に入力します：
        ```text
        http://localhost:3000/oauth/callback
        ```
    *   ※ 末尾にスラッシュなどを余計につけないでください。
5.  「**作成**」をクリックします。

## 5. クライアント ID とシークレットの取得

1.  作成が完了すると、「OAuth クライアントを作成しました」というポップアップが表示されます。
2.  ここに表示される以下の2つの値をコピーします：
    *   **クライアント ID** (Client ID)
    *   **クライアント シークレット** (Client Secret)
3.  「OK」をクリックして閉じます。

## 6. アプリケーションへの設定反映

コピーした値を、アプリケーションの `.env` ファイルに設定します。

1.  プロジェクトフォルダ内の `.env` ファイルを開きます。
2.  以下の項目を書き換えます（既存の値がある場合は上書きしてください）：

```env
GMAIL_CLIENT_ID=コピーしたクライアントID
GMAIL_CLIENT_SECRET=コピーしたクライアントシークレット
GMAIL_REDIRECT_URI=http://localhost:3000/oauth/callback
```

3.  ファイルを保存します。
4.  アプリケーションを再起動します。

## 7. 認証の実行

1.  アプリを起動し、設定画面から「アカウント追加」を行います。
2.  ブラウザが開くので、**テストユーザーに登録したGoogleアカウント**でログインします。
3.  「このアプリはGoogleで確認されていません」という警告が出た場合：
    *   「詳細」または「Advanced」をクリックします。
    *   「(アプリ名)（安全ではないページ）に移動」をクリックして進めます。
4.  リダイレクト後、ブラウザのアドレスバーから `code=...` の部分をコピーし、アプリに入力してください。
